var currentDate=new Date,dayCounter=0,createNewDate=function(){return new Date(currentDate.getFullYear(),currentDate.getMonth(),currentDate.getDate()+dayCounter)},formatedDate=function(e){var t=createNewDate(),a={0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"},d={0:"January",1:"Febuary",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"};return nthStr=t.getDate()%10===1&&11!==t.getDate()?"st":t.getDate()%10===2&&12!==t.getDate()?"nd":t.getDate()%10===3&&13!==t.getDate()?"rd":"th","day"===e?(dayCounter++,a[t.getDay()]+" the "+t.getDate()+nthStr):"The week of "+d[t.getMonth()]+" the "+t.getDate()+nthStr+", "+t.getFullYear()},checkForSunday=function(){return 0===createNewDate().getDay()?"<div class = 'week-header'>"+formatedDate("header")+"</div>":""},addWeek=function(){$(".main-wrapper").append("<div class = 'day-block editable'>"+formatedDate("day")+"</div>"+checkForSunday()+"<div class = 'day-block editable'>"+formatedDate("day")+"</div>"+checkForSunday()+"<div class = 'day-block editable'>"+formatedDate("day")+"</div>"+checkForSunday()+"<div class = 'day-block editable'>"+formatedDate("day")+"</div>"+checkForSunday()+"<div class = 'day-block editable'>"+formatedDate("day")+"</div>"+checkForSunday()+"<div class = 'day-block editable'>"+formatedDate("day")+"</div>"+checkForSunday()+"<div class = 'day-block editable'>"+formatedDate("day")+"</div>"+checkForSunday())},attachInputEvents=function(){$(".event-input").bind("enterKey",function(){$(this).prev(".day-block").addClass("editable");var e=$(this).val();$(this).replaceWith("<div class = 'editableEvent'>"+e+"</div>")}),$(".event-input").keyup(function(e){13==e.keyCode&&$(this).trigger("enterKey")})};addWeek(),$(document).on("ready",function(){$("body").height()<$(window).height()&&addWeek(),$(document).on("scroll",function(){$("body").height()-200<$(window).height()+$("body").scrollTop()&&addWeek()}),$(document).on("click",".day-block",function(){$(this).hasClass("editable")&&$(this).after("<input class = 'event-input' placeholder = 'Enter event details'>"),$(this).removeClass("editable"),attachInputEvents(),$(this).next().focus()}),$(document).on("click",".editableEvent",function(){var e=$(this).text();$(this).replaceWith("<input class = 'event-input' value= '"+e+"'>"),attachInputEvents()})});